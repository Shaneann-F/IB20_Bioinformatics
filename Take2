#This script is to look for two genes in any species
#
#Input is found in one location. Output will be presented in a table.

#This loop will combine all the files for gene1 into one fasta file
for gene in "$1"
do
cat $gene >> gene1.fa
done

#This loop will combine all the files for gene1 into one fasta file
for gene in "$2"
do
cat $gene >> gene2.fa
done

#This loop will align the sequences of gene1
for align in "$3"
do
./muscle -in $align -out gene1.afa
done

#This loop will align the sequences of gene2
for align in "$4"
do
./muscle -in $align -out gene2.afa
done

#This loop will use hmm build to generate a regular expression for gene1
for build in "$5"
do
./hmmbuild gene1.hmm $build
Done

#This loop will use hmm build to generate a regular expression for gene2
for build in "$6"
do
./hmmbuild gene2.hmm $build
done

#This loop is for hmm search to generate a table for gene1 and gene2
for proteome in "$7"
do
./hmmsearch --tblout genesOfInterest.tblout gene1.hmm gene1.afa $proteome
./hmmsearch --tblout genesOfInterest2.tblout gene2.hmm gene2.afa $proteome
done

#Now we search for the proteomes which contain hsp and mcr genes of interest
cat genesOfInterest1.tblout | grep ^WP_ | wc -l >> matches.txt
cat genesOfInterest2.tblout | grep ^WP_ | wc -l >> matches.txt

#Now we organize our proteome matches
cat matches.txt | grep -v “ 0” | sort - >> finalMatches.txt
